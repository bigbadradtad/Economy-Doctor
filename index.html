<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Economy Doctor</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    margin:0;
    padding:0;
  }
  #loadingScreen {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: #111; display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    touch-action: manipulation;
    cursor: pointer;
  }
  #game { display:none; }
  .slider-container { 
    margin: 20px 0; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    gap: 15px;
  }
  .slider { 
    width: 250px; 
    height: 25px; 
    touch-action: manipulation; 
  }
  .icon { font-size: 28px; }
  .gauge {
    width: 120px; 
    height: 15px;
    background: #333; border-radius: 5px; overflow:hidden;
  }
  .fill {
    height: 100%; width: 50%; background: lime;
    transition: width 0.3s, background 0.3s;
  }
  #healthBar {
    width: 320px; height: 25px;
    background: #333; margin: 20px auto;
    border-radius: 10px; overflow: hidden;
  }
  #healthFill {
    height:100%; width:100%; background:lime;
    transition: width 0.5s, background 0.5s;
  }
  #reflexBox {
    width: 250px; height: 250px;
    border: 2px solid white; margin: 25px auto;
    position: relative;
  }
  .target {
    width: 30px; height: 30px;
    background: red; border-radius: 50%;
    position: absolute; cursor:pointer;
    animation: pulse 0.6s;
  }
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }
  @keyframes flash {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
  }
  #eventLog {
    margin-top: 20px;
    padding: 10px;
    background: #222;
    border-radius: 5px;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    text-align: left;
    font-size: 14px;
    min-height: 60px;
  }
</style>
</head>
<body>

<div id="loadingScreen" onclick="startGame()">
  <h1>Economy Doctor</h1>
  <p>Balance the economy‚Äôs vitals: GDP, Employment, and Sentiment.</p>
  <p>Fight off <span style="color:red;">Inflation Shocks</span> using the Reflex Box.</p>
  <p><b>Controls:</b> Move sliders to adjust indicators. Click red circles in the Reflex Box to stabilize inflation.</p>
  <p>Tap anywhere to begin.</p>
</div>

<div id="game">
  <h2>Economic Health ‚ù§Ô∏è</h2>
  <div id="healthBar"><div id="healthFill"></div></div>

  <div class="slider-container">
    <span class="icon">üí∞</span>
    GDP
    <input type="range" min="0" max="100" value="50" class="slider" id="gdp-control">
    <div class="gauge"><div class="fill" id="gdpGauge"></div></div>
  </div>

  <div class="slider-container">
    <span class="icon">üßë‚Äçüíº</span>
    Employment
    <input type="range" min="0" max="100" value="50" class="slider" id="emp-control">
    <div class="gauge"><div class="fill" id="empGauge"></div></div>
  </div>

  <div class="slider-container">
    <span class="icon">üìà</span>
    Sentiment
    <input type="range" min="0" max="100" value="50" class="slider" id="sent-control">
    <div class="gauge"><div class="fill" id="sentGauge"></div></div>
  </div>

  <h3>Reflex Box (Inflation)</h3>
  <div id="reflexBox"></div>

  <div id="eventLog">
    <b>Event Log:</b>
    <div id="eventMessages"></div>
  </div>
</div>

<script>
let gdp=50, emp=50, sent=50, inflation=20;
const gdpSlider=document.getElementById('gdp-control');
const empSlider=document.getElementById('emp-control');
const sentSlider=document.getElementById('sent-control');
const gdpGauge=document.getElementById('gdpGauge');
const empGauge=document.getElementById('empGauge');
const sentGauge=document.getElementById('sentGauge');
const healthFill=document.getElementById('healthFill');
const reflex=document.getElementById('reflexBox');
const eventMessages=document.getElementById('eventMessages');

let inflationTimer = 0;
let eventTimer = 0;

function getColor(value){
  if(value>66) return "lime";
  if(value>33) return "yellow";
  return "red";
}

function updateGauge(value, gauge){
  gauge.style.width=value+"%";
  gauge.style.background=getColor(value);
}

function updateHealth(){
  let score = gdp*0.35 + emp*0.35 + sent*0.3 - inflation*0.3;
  score=Math.max(0, Math.min(100, score));
  healthFill.style.width=score+"%";
  healthFill.style.background=getColor(score);
}

function flashHealth(color){
  healthFill.style.background = color;
  healthFill.style.animation = 'flash 0.3s';
  setTimeout(()=>{
    healthFill.style.animation = '';
    updateHealth();
  }, 300);
}

function logEvent(text, color){
  const line=document.createElement('div');
  line.textContent=text;
  line.style.color=color;
  eventMessages.appendChild(line);
  while(eventMessages.children.length>5){
    eventMessages.removeChild(eventMessages.firstChild);
  }
}

function gameTick(){
  emp += (gdp-50)*0.01;
  sent += (emp-50)*0.01;

  gdp -= inflation*0.01;
  emp -= inflation*0.005;
  sent -= inflation*0.005;

  gdp += (parseInt(gdpSlider.value)-50)*0.05;
  emp += (parseInt(empSlider.value)-50)*0.05;
  sent += (parseInt(sentSlider.value)-50)*0.05;

  gdp=Math.max(0,Math.min(100,gdp));
  emp=Math.max(0,Math.min(100,emp));
  sent=Math.max(0,Math.min(100,sent));

  updateGauge(gdp,gdpGauge);
  updateGauge(emp,empGauge);
  updateGauge(sent,sentGauge);
  updateHealth();

  inflationTimer++;
  if(inflationTimer>=50){
    spawnShock();
    inflationTimer=0;
  }

  if(Math.random()<0.002 && eventTimer<=0){
    triggerEvent();
    eventTimer=500;
  } else { eventTimer--; }
}

function spawnShock(){
  const target=document.createElement('div');
  target.classList.add('target');
  target.style.left=Math.random()*(reflex.offsetWidth-30)+"px";
  target.style.top=Math.random()*(reflex.offsetHeight-30)+"px";
  reflex.appendChild(target);

  setTimeout(()=>{ 
    if(document.body.contains(target)){
      target.remove();
      inflation = Math.min(100, inflation+15);
      sent = Math.max(0, sent-5);
      gdp = Math.max(0, gdp-5);
      emp = Math.max(0, emp-5);
      logEvent("Inflation Shock missed!", "red");
      flashHealth('red');
    }
  }, 2000);

  target.addEventListener('click',()=>{
    inflation=Math.max(0, inflation-15);
    sent=Math.min(100, sent+10);
    gdp=Math.min(100, gdp+5);
    emp=Math.min(100, emp+5);
    target.remove();
    logEvent("Inflation Stabilized", "lime");
    flashHealth('lime');
  });
}

function triggerEvent(){
  const r = Math.random();
  if(r<0.25){ 
    gdp-=20; emp-=15; sent-=15; logEvent("Recession hits! GDP, Employment, and Sentiment fall.", "orange"); 
  }
  else if(r<0.5){ 
    gdp+=20; emp+=15; sent+=15; logEvent("Economic Boom! Growth across the board.", "lime"); 
  }
  else if(r<0.75){ 
    sent-=25; inflation+=20; logEvent("Confidence Crisis! Sentiment drops, Inflation rises.", "red"); 
  }
  else{ 
    gdp+=15; emp+=15; sent+=10; logEvent("Tech Breakthrough! Productivity surges.", "cyan"); 
  }
  gdp=Math.max(0,Math.min(100,gdp));
  emp=Math.max(0,Math.min(100,emp));
  sent=Math.max(0,Math.min(100,sent));
  inflation=Math.max(0,Math.min(100,inflation));
}

setInterval(gameTick,100);

function startGame(){
  document.getElementById('loadingScreen').style.display='none';
  document.getElementById('game').style.display='block';
}

document.addEventListener('keydown', e => {
  if(e.code==="Space"){
    startGame();
  }
});
</script>
</body>
</html>
